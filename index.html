<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShortNotes-v1</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <style>
        :root {
            --indent-size: 20px;
            --card-padding: 10px;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }

        .cards-list {
            display: flex;
            flex-direction: column;
            gap: 5px;
            width: 100%;
        }

        .topic-wrapper {
            margin-bottom: 5px;
            width: 100%;
        }

        .topic-name {
            font-weight: bold;
            color: #333;
            cursor: pointer;
            padding: 5px 0;
        }

        .card {
            background-color: transparent;
            margin-top: 10px;
            display: none;
            width: 100%;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        .card-content {
            padding: var(--card-padding);
        }

        .card-title {
            font-size: 1.2em;
            color: #333;
            font-weight: bold;
            margin-bottom: 5px;
            cursor: pointer;
        }

        .description-box {
            margin-bottom: 10px;
        }

        .code-and-output {
            display: flex;
            gap: 20px;
        }

        .code-snippet-wrapper {
            flex: 1;
            background-color: #f5f5f5;
            border-radius: 5px;
            overflow: hidden;
        }

        .code-snippet {
            font-family: "Courier New", Courier, monospace;
            font-size: 0.9em;
        }

        .code-snippet pre {
            margin: 0;
            padding: 10px;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #e0e0e0;
            padding: 5px 10px;
        }

        .language-options {
            display: flex;
            gap: 10px;
        }

        .language-option {
            font-size: 0.8em;
            cursor: pointer;
            color: #333;
        }

        .language-option.active {
            font-weight: bold;
            color: #0066cc;
        }

        .copy-text {
            color: #333;
            cursor: pointer;
        }

        .output-wrapper {
            flex: 1;
            background-color: #f9f9f9;
            border-radius: 5px;
            padding: 10px;
        }

        .sub-topics {
            margin-left: var(--indent-size);
        }

        .card.expanded {
            display: block;
        }
    </style>
</head>

<body>
    <div id="cardsList" class="cards-list">
        <!-- Cards will be dynamically added here -->
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>

    <script>
        const cardsList = document.getElementById('cardsList');

        function createCard(topicName, cardData, level = 0) {
            const wrapper = document.createElement('div');
            wrapper.className = `topic-wrapper level-${level}`;

            const topicNameElement = document.createElement('div');
            topicNameElement.className = 'topic-name';
            topicNameElement.textContent = topicName;

            const card = document.createElement('div');
            card.className = 'card';

            let codeAndOutputHTML = '';
            if (cardData.codeSnippets && cardData.codeSnippets.length > 0) {
                codeAndOutputHTML = `
                    <div class="code-and-output">
                        <div class="code-snippet-wrapper">
                            <div class="code-header">
                                <div class="language-options">
                                    ${cardData.codeSnippets.map((snippet, index) => `
                                        <span class="language-option ${index === 0 ? 'active' : ''}" data-language="${snippet.language}">${snippet.language}</span>
                                    `).join('')}
                                </div>
                                <span class="copy-text">Copy</span>
                            </div>
                            <div class="code-snippet">
                                <pre><code class="language-${cardData.codeSnippets[0].language.toLowerCase()}">${cardData.codeSnippets[0].code}</code></pre>
                            </div>
                        </div>
                        <div class="output-wrapper">
                            <h4>Output:</h4>
                            <pre>${cardData.output || 'No output available'}</pre>
                        </div>
                    </div>
                `;
            }

            let subTopicsHTML = '';
            if (cardData.subTopics) {
                subTopicsHTML = `<div class="sub-topics"></div>`;
            }

            card.innerHTML = `
                <div class="card-content">
                    <div class="card-title">${topicName}</div>
                    <div class="description-box">
                        <p>${cardData.description}</p>
                    </div>
                    ${codeAndOutputHTML}
                    ${subTopicsHTML}
                </div>
            `;

            wrapper.appendChild(topicNameElement);
            wrapper.appendChild(card);

            const codeSnippet = card.querySelector('.code-snippet');
            const copyText = card.querySelector('.copy-text');
            const languageOptions = card.querySelectorAll('.language-option');

            function updateCodeSnippet(language) {
                const snippet = cardData.codeSnippets.find(s => s.language.toLowerCase() === language.toLowerCase());
                if (snippet) {
                    codeSnippet.innerHTML = `<pre><code class="language-${snippet.language.toLowerCase()}">${snippet.code}</code></pre>`;
                    Prism.highlightElement(codeSnippet.querySelector('code'));
                }
            }

            languageOptions.forEach(option => {
                option.addEventListener('click', function() {
                    languageOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    updateCodeSnippet(this.dataset.language);
                });
            });

            if (copyText) {
                copyText.addEventListener('click', function () {
                    const code = codeSnippet.querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        this.textContent = 'Copied!';
                        setTimeout(() => {
                            this.textContent = 'Copy';
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy text: ', err);
                    });
                });
            }

            function toggleCard() {
                wrapper.classList.toggle('expanded');
                card.classList.toggle('expanded');
                topicNameElement.style.display = card.classList.contains('expanded') ? 'none' : 'block';

                if (card.classList.contains('expanded')) {
                    Prism.highlightAll();
                    if (cardData.subTopics) {
                        const subTopicsContainer = card.querySelector('.sub-topics');
                        if (subTopicsContainer.children.length === 0) {
                            Object.entries(cardData.subTopics).forEach(([subTopicName, subTopicData]) => {
                                const subTopicCard = createCard(subTopicName, subTopicData, level + 1);
                                subTopicsContainer.appendChild(subTopicCard);
                            });
                        }
                    }
                }

                // Resize all parent cards
                let currentWrapper = wrapper;
                let currentLevel = level;
                while (currentWrapper && currentLevel > 0) {
                    const parentWrapper = currentWrapper.parentElement.closest('.topic-wrapper');
                    if (parentWrapper) {
                        const parentCard = parentWrapper.querySelector('.card');
                        if (parentCard) {
                            parentCard.style.width = `calc(100% + ${var(--indent-size) * (level - currentLevel + 1)}px)`;
                        }
                    }
                    currentWrapper = parentWrapper;
                    currentLevel--;
                }
            }

            topicNameElement.addEventListener('click', toggleCard);
            card.querySelector('.card-title').addEventListener('click', toggleCard);

            return wrapper;
        }

        function loadCardsFromJSON() {
            fetch('content.json')
                .then(response => response.json())
                .then(data => {
                    Object.entries(data).forEach(([topicName, cardData]) => {
                        const card = createCard(topicName, cardData);
                        cardsList.appendChild(card);
                    });
                })
                .catch(error => console.error('Error loading JSON:', error));
        }

        document.addEventListener('DOMContentLoaded', loadCardsFromJSON);
    </script>
</body>

</html>
